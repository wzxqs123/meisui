<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>我的</title>
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
        <meta name="format-detection" content="telephone=no">
        <link rel="stylesheet" type="text/css" href="css/index.css">
        <style type="text/css">
            html, body {
                background: #f4f5f1 url("images/my-wrap.png") center 0 no-repeat;
                background-size: 100%;
            }
        </style>
    </head>
    <body>
        <div class="my-wrap">
            <header class="my-head">
                <div class="my-headpic position-rel">
                    <img class="block img" src="images/demoimages/pic11.png" alt="" />
                    <input class="my-picfile position-abs" type="file" />
                </div>
                <div class="my-headname thirty white text-center weight-bold"><em>黄老邪</em></div>
                <div class="my-headpeo my-yellow twenty-four clearfix">
                    <em class="weight-bold left">ID:</em>
                    <span id="my-idnum" class="my-idnum weight-bold left">00000000</span>
                    <div id="my-copy" class="my-copy left">复制</div>
                </div>
                <p class="my-graph twenty-four text-center"><em></em></p>
                <div class="my-nav twenty-four text-center white clearfix">
                    <!-- 选中添加my-navsel类 -->
                    <span class="my-data my-navsel left">个人资料</span>
                    <span class="my-record left">竞猜记录</span>
                    <span class="my-follow left">关注</span>
                </div>
            </header>
            <div class="my-query bg-white text-center twenty-four clearfix">
                <a href="integral.html" class="my-queryjf left three">积分</a>
                <a href="recharge.html" class="my-querycz left three">充值</a>
                <a href="give.html" class="my-queryzs left three">赠送</a>
            </div>
            <div class="my-layer">
                <!-- 个人资料 -->
                <div class="my-datacon">
                    <ul class="my-alink bg-white">
                        <li class="my-surplus my-dataitem thirty position-rel clearfix">
                            <a href="javascript:;" class="my-item thirty position-rel block bg-white clearfix">
                                <span class="nine left">剩余积分</span>
                                <em class="three deta-red weight-bold right">10000</em>
                            </a>
                        </li>
                        <li class="my-share my-dataitem thirty position-rel clearfix">
                            <a href="share.html" class="my-item thirty position-rel block bg-white clearfix">
                                <span class="nine left">分享</span>
                                <em class="three deta-red weight-bold right">分享有奖</em>
                                <i class="my-itemarrow position-abs"></i>
                            </a>
                        </li>
                        <li class="my-invite my-dataitem thirty position-rel clearfix">
                            <a href="invitation-record.html" class="my-item thirty position-rel block bg-white clearfix">
                                <span class="nine left">邀请记录</span>
                                <em class="three deta-red weight-bold right">查看</em>
                                <i class="my-itemarrow position-abs"></i>
                            </a>
                        </li>
                    </ul>
                    <ul class="my-datalist bg-white">
                        <li class="my-dataname my-dataitem thirty position-rel clearfix">
                            <span class="nine left">真实姓名</span>
                            <em class="three weight-bold right">李冰</em>
                            <i class="my-dataarrow position-abs"></i>
                        </li>
                        <li class="my-dataphone my-dataitem thirty position-rel clearfix">
                            <span class="nine left">手机号码</span>
                            <em class="three weight-bold right">15492831723</em>
                            <i class="my-dataarrow position-abs"></i>
                        </li>
                        <li class="my-datawx my-dataitem thirty position-rel clearfix">
                            <span class="nine left">微信号</span>
                            <em class="three weight-bold right">会飞的鱼</em>
                            <i class="my-dataarrow position-abs"></i>
                        </li>
                        <li class="my-dataqq my-dataitem thirty position-rel clearfix">
                            <span class="nine left">QQ号码</span>
                            <em class="three weight-bold right">91277362</em>
                            <i class="my-dataarrow position-abs"></i>
                        </li>
                        <li class="my-datashdz my-dataitem thirty position-rel clearfix">
                            <span class="nine left">收货地址</span>
                            <em class="three weight-bold right">福建省厦门市集美区理工路852号3栋2楼(208)</em>
                            <i class="my-dataarrow position-abs"></i>
                        </li>
                        <li class="my-datadhjl my-dataitem thirty position-rel clearfix">
                            <a href="record-exchange.html" class="left clearfix">
                                <span class="nine left">兑换记录</span>
                                <em class="three weight-bold right">查看</em>
                                <i class="my-dataarrow position-abs"></i>
                            </a>
                        </li>
                    </ul>
                    <a href="sign-in.html" class="my-signout block deta-red text-center thirty bg-white">退出登录</a>
                    <a href="forget-password.html" class="my-signout block deta-red text-center thirty bg-white">修改密码</a>
                </div>
                <!-- 竞猜记录 -->
                <div class="my-recordcon none">
                    <ul class="my-recolist">
                        <li class="my-recoitem bg-white position-rel">
                            <!-- 标签 -->
                            <div class="my-recotype white twenty-four position-abs"><span class="block">猜胜负</span></div>
                            <h2 class="text-center thirty weight-bold">竞猜皇马胜利-竞猜100</h2>
                            <div class="my-recocom thirty clearfix">
                                <div class="my-recovs left clearfix">
                                    <span class="left">皇马</span>
                                    <em class="weight-bold left">3:1</em>
                                    <span class="left">巴塞</span>
                                </div>
                                <div class="my-recores weight-bold right clearfix">
                                    <span class="left">皇马</span>
                                    <!-- 胜标签则添加类my-recowin,负标签则添加类my-recofail,负标签则添加类my-recoflat否则标签不添加这两个类 -->
                                    <em class="my-recoflat left">平</em>
                                </div>
                            </div>
                            <div class="my-recoval nine clearfix">
                                <div class="twenty-four left">2018-10-12 18:00:00</div>
                                <em class="twenty-four left">赔率 2:4</em>
                                <!-- 无添加deta-red，有添加index-greencolor -->
                                <span class="deta-red thirty weight-bold right">收入:无</span>
                            </div>
                        </li>
                    </ul>
                </div>
                <!-- 关注 -->
                <div class="my-follcon none">
                    <ul class="my-folllist">
                        <li class="my-follitem bg-white">
                            <div class="new-m-timel clearfix">
                                <div class="new-m-timecom thirty left weight-bold clearfix">
                                    <!-- 如果是平局my-follwin改成my-follpj -->
                                    <span class="left position-rel">马竞<em class="my-follpj position-abs">平</em></span>
                                    <i class="left"></i>
                                    <span class="left position-rel">啊森纳<em class="my-follwin position-abs none">胜</em></span>
                                </div>
                                <!-- 已关注添加类名new-m-followed -->
                                <a href="gues-details.html" class="new-m-timegz right white weight-bold text-center twenty-six">跟单</a>
                            </div>
                            <div class="new-m-timer clearfix">
                                <p class="new-m-timetip nine twenty-four left">2018-01-12 18:00 开赛</p>
                                <a href="gues-details.html" class="new-m-timejc block right nine twenty-four">已有20人竞猜&nbsp>></a>
                            </div>
                            <div class="my-follwc twenty-four weight-bold deta-red">已竞猜2单</div>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- 渐隐弹窗 -->
            <div class="my-fadealert text-center white position-fix none">复制成功</div>
            <!-- 修改信息弹窗 -->
            <form action="" class="my-infoalebg position-fix none">
                <div class="my-infoale thirty text-center bg-white position-abs">
                    <!-- 关闭按钮 -->
                    <span class="my-infoclose position-abs"></span>
                    <h2 class="weight-bold"></h2>
                    <input class="my-input block text-center" type="text" placeholder="请输入真实姓名" />
                    <button class="my-infobut white block" type="button">保存</button>
                </div>
            </form>
            <!-- 导航 -->
            <nav class="nav clearfix bg-white twenty-four text-center weight-bold position-fix">
                <!-- 选中的类名加sel，例如nav-index选中为nav-indexsel -->
                <a href="index.html" class="nav-index left three">首页</a>
                <a href="ranking-list.html" class="nav-list left three">神算榜</a>
                <a href="gues-compet.html" class="nav-guess left three">竞猜</a>
                <a href="javascript:;" class="nav-mysel left three">我的</a>
            </nav>
        </div>
        <script src="js/jquery-1.11.3.min.js" type="text/javascript"></script>
        <script src="js/index.js" type="text/javascript"></script>
        <script type="text/javascript">
            // 列表最后一项虚线删除处理
            function itemNum (items) {
                var xflistsitem = $(items).size() - 1;
                $(items).eq(xflistsitem).css({
                    "border-bottom" : "none"
                });
            }
            itemNum(".my-alink .my-dataitem");
            itemNum(".my-datalist .my-dataitem");

            // tap切换
            $(".my-nav").on('click', 'span', function () {
                var indexNum = $(this).index();
                $(this).addClass("my-navsel").siblings("span").removeClass("my-navsel");
                $(".my-layer").children("div").eq(indexNum).removeClass("none");
                $(".my-layer").children("div").eq(indexNum).siblings("div").addClass("none");
            });

            // 复制功能
            function copyArticle(event){
                const range = document.createRange();
                range.selectNode(document.getElementById('my-idnum'));

                const selection = window.getSelection();
                if(selection.rangeCount > 0) selection.removeAllRanges();
                selection.addRange(range);
                
                document.execCommand('copy');

                // 复制成功弹出渐隐弹窗
                $(".my-fadealert").html("复制成功");
                $(".my-fadealert").fadeIn(300, function () {
                    // 复制成功提示淡出
                    $(this).fadeOut(2500);
                })
            }
            document.getElementById('my-copy').addEventListener('click', copyArticle, false);

            /*// 关注功能
            $(".new-m-timegz").click(function(event) {
                if ($(this).hasClass("new-m-followed")) {
                    $(this).removeClass("new-m-followed");
                    $(this).html("关注");
                } else {
                    $(this).addClass("new-m-followed");
                    $(this).html("已关注");
                }
                
            });*/

            // 关闭弹窗
            function closeAlert (butEve, bgEve) {
                $(butEve).click(function () {
                    $(bgEve).addClass("none");
                    relievescroll(); // 解除锁定
                });
            }
            closeAlert(".my-infoclose", ".my-infoalebg");
            freeBlank(".my-infoalebg", ".my-infoale", "none");

            // 打开页面时判断服务端是否有返回个性姓名的值
            var graphCon = $(".my-graph em").html();
            if (graphCon == "") {
                $(".my-graph em").html("点击编辑个性姓名");
            } else {
                $(".my-graph em").addClass("white");
            }
            // 修改信息
            var conAir = /^[\s]*$/;
            var chinaWord = /^[\u4E00-\u9FA5]{2,4}$/;
            function infoAlert (conEve, titcon, zwfword, butClass, maxNum, maxwords, emptypro, emcolor) {
                $(conEve).click(function(event) {
                    var _this = $(this);
                    $(".my-infobut").remove();
                    $(".my-infoalebg").removeClass("none");
                    $(".my-infoale h2").html(titcon);
                    $(".my-input").attr({
                        "placeholder" : zwfword
                    });
                    // 重置输入框
                    $(".my-input").val("");
                    $(".my-input").removeClass("infoerror");
                    lockscroll(); // 锁定滚动条

                    // 判断是否是输入手机号或是QQ号，是则type类型改为number，否type类型为text
                    if (_this.hasClass("my-dataphone") || _this.hasClass("my-dataqq")) {
                        $(".my-input").attr({
                            "type" : "number"
                        })
                    } else {
                        $(".my-input").attr({
                            "type" : "text"
                        })
                    }

                    // 获取原先的数据
                    var initialCon = _this.children("em").html();
                    $(".my-input").val(initialCon);
                    
                    $(".my-infoale").append("<button class='my-infobut " + butClass + " white block' type='button'>保存</button>");
                    $("." + butClass).click(function (e) {
                        $(".my-input").blur();
                        var inputCons = $(".my-input").val();
                        // 判断是否是手机号那栏
                        if (_this.hasClass("my-dataphone")) {
                            // 判断手机格式是否正确
                            if (phoneReg.test(inputCons)) {
                                // 手机格式正确且不为空
                                
                                // 这里发送数据给服务端
                                console.log(inputCons);

                                // 关闭弹窗
                                $(".my-infoalebg").addClass("none");
                                relievescroll(); // 解除锁定
                                _this.children("em").html(inputCons);
                            } else {
                                // 手机格式错误
                                $(".my-input").val("");
                                $(".my-input").addClass("infoerror");
                                $(".my-input").attr({
                                    "placeholder" : "请输入正确的手机号"
                                })
                            }
                        } else if (_this.hasClass("my-dataname")) {
                            if (chinaWord.test(inputCons)) {
                                // 这里发送数据给服务端
                                console.log(inputCons);

                                // 关闭弹窗
                                $(".my-infoalebg").addClass("none");
                                relievescroll(); // 解除锁定
                                _this.children("em").html(inputCons);
                            } else {
                                // 真实名字填写错误
                                $(".my-input").val("");
                                $(".my-input").addClass("infoerror");
                                $(".my-input").attr({
                                    "placeholder" : "请输入正确的中文名"
                                })
                            }
                        } else {
                            var len = inputCons.match(/[^ -~]/g) == null ? inputCons.length : inputCons.length + inputCons.match(/[^ -~]/g).length;
                            if (!conAir.test(inputCons)) {
                                if (len <= maxNum) {
                                    // 这里发送数据给服务端
                                    console.log(inputCons);

                                    // 关闭弹窗
                                    $(".my-infoalebg").addClass("none");
                                    relievescroll(); // 解除锁定
                                    _this.children("em").html(inputCons).addClass(emcolor);
                                } else {
                                    $(".my-input").val("");
                                    $(".my-input").addClass("infoerror");
                                    $(".my-input").attr({
                                        "placeholder" : maxwords
                                    })
                                }
                            } else {
                                $(".my-input").val("");
                                $(".my-input").addClass("infoerror");
                                $(".my-input").attr({
                                    "placeholder" : emptypro
                                })
                            }
                        }
                    });
                });
            }
            infoAlert(".my-headname", "编辑昵称", "请输入昵称", "my-ncbut", 14, "最多14个字符", "内容不能为空");
            infoAlert(".my-graph", "编辑个性签名", "请输入个性签名", "my-gxqmbut", 40, "最多40个字符", "内容不能为空", "white");
            infoAlert(".my-dataname", "编辑真实姓名", "请输入真实姓名", "my-zsxmbut");
            infoAlert(".my-dataphone", "编辑手机号码", "请输入手机号码", "my-sjhmbut");
            infoAlert(".my-datawx", "编辑微信号", "请输入微信号", "my-wxhbut", 40, "最多40个字符", "内容不能为空");
            infoAlert(".my-dataqq", "编辑QQ号", "请输入QQ号", "my-qqhbut", 40, "最多40个字符", "内容不能为空");
            infoAlert(".my-datashdz", "编辑收货地址", "请输入收货地址", "my-shdzbut", 80, "最多80个字符", "内容不能为空");
        </script>
    </body>
</html>