<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>美图</title>
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
        <meta name="format-detection" content="telephone=no">
        <!-- <link rel="stylesheet" type="text/css" href="css/dropload.css" /> -->
        <link rel="stylesheet" type="text/css" href="css/swiper.3.1.7.min.css" />
        <link rel="stylesheet" type="text/css" href="css/index.css">
        <style type="text/css">
            html, body {
                background: #f9f4f5;
            }
        </style>
        
    </head>
    <body>
        <div class="pic-l-wrap">
            <!-- 标题部分 -->
            <div class="pubtit bg-white clearfix">
                <h2 class="text-center thirty-two">美图</h2>
            </div>
            <div class="pic-l-nav swiper-containers three twenty-six">
                <div class="swiper-wrapper clearfix">
                    <!-- 最新修改 -->
                    <a href="javascript:;" class="swiper-slide pic-l-navitem left clearfix position-rel three">
                        <span class="left pic-l-navsel position-rel">最新<em class="position-abs"></em></span>
                    </a>
                    <a href="javascript:;" class="swiper-slide pic-l-navitem left position-rel three">
                        <span class="left position-rel">最热<em class="position-abs none"></em></span>
                    </a>
                    <a href="javascript:;" class="swiper-slide pic-l-navitem left position-rel three">
                        <span class="left position-rel">尤物<em class="position-abs none"></em></span>
                    </a>
                    <a href="javascript:;" class="swiper-slide pic-l-navitem left position-rel three">
                        <span class="left position-rel">人气<em class="position-abs none"></em></span>
                    </a>
                    <a href="javascript:;" class="swiper-slide pic-l-navitem left position-rel three">
                        <span class="left position-rel">爆乳<em class="position-abs none"></em></span>
                    </a>
                    <a href="javascript:;" class="swiper-slide pic-l-navitem left position-rel three">
                        <span class="left position-rel">透视<em class="position-abs none"></em></span>
                    </a>
                </div>
            </div>
            <!-- 列表内容 -->
            <div id="pic-l-layerbg" class="pic-l-layerbg bg-white">
                <!-- 最新修改-2018-4-11 -->
                <div id="pic-l-list" class="pic-l-list position-rel clearfix">
                    <!-- 子项1 -->
                    <a href="" class="pic-l-item left position-rel">
                        <img src="http://xlsns.ufile.ucloud.com.cn/5694aecd85804e93a3a8d7ec285a32d0.jpg" alt="" class="pic-l-pics block img">
                        <span class="pic-l-perinfo clearfix white position-abs">
                            <img src="images/demoimages/pic1.png" alt="" class="left">
                            <span class="left">奶牛个巴子</span>
                            <em class="right">10分钟前</em>
                        </span>
                    </a>
                    <a href="" class="pic-l-item left position-rel">
                        <img src="http://xlsns.ufile.ucloud.com.cn/aa5b0ba7fdab480298bde63492a08f13.jpg" alt="" class="pic-l-pics block img">
                        <span class="pic-l-perinfo clearfix white position-abs">
                            <img src="images/demoimages/pic1.png" alt="" class="left">
                            <span class="left">奶牛个巴子</span>
                            <em class="right">10分钟前</em>
                        </span>
                    </a>
                    <a href="" class="pic-l-item left position-rel">
                        <img src="http://xlsns.ufile.ucloud.com.cn/f707ea6216804954a4bba01373da77a6.jpg" alt="" class="pic-l-pics block img">
                        <span class="pic-l-perinfo clearfix white position-abs">
                            <img src="images/demoimages/pic1.png" alt="" class="left">
                            <span class="left">奶牛个巴子</span>
                            <em class="right">10分钟前</em>
                        </span>
                    </a>
                    <a href="" class="pic-l-item left position-rel">
                        <img src="http://xlsns.ufile.ucloud.com.cn/3c1a611141fd41578211e17619981ac8.jpg" alt="" class="pic-l-pics block img">
                        <span class="pic-l-perinfo clearfix white position-abs">
                            <img src="images/demoimages/pic1.png" alt="" class="left">
                            <span class="left">奶牛个巴子</span>
                            <em class="right">10分钟前</em>
                        </span>
                    </a>
                    <a href="" class="pic-l-item left position-rel">
                        <img src="http://xlsns.ufile.ucloud.com.cn/6d7bc7f886da4fb89d3d24f4ffb12974.jpg" alt="" class="pic-l-pics block img">
                        <span class="pic-l-perinfo clearfix white position-abs">
                            <img src="images/demoimages/pic1.png" alt="" class="left">
                            <span class="left">奶牛个巴子</span>
                            <em class="right">10分钟前</em>
                        </span>
                    </a>
                    <a href="" class="pic-l-item left position-rel">
                        <img src="http://xlsns.ufile.ucloud.com.cn/6d7bc7f886da4fb89d3d24f4ffb12974.jpg" alt="" class="pic-l-pics block img">
                        <span class="pic-l-perinfo clearfix white position-abs">
                            <img src="images/demoimages/pic1.png" alt="" class="left">
                            <span class="left">奶牛个巴子</span>
                            <em class="right">10分钟前</em>
                        </span>
                    </a>
                    <!-- 子项2 -->
                    <!-- <a href="" class="pic-l-itemtwo block">
                        <a href="" class="pic-l-pictwo block">
                            <img src="images/demoimages/pic2.png" data-echo="images/demoimages/pic8.png" alt="" class="block img">
                        </a>
                        <a href="" class="pic-l-twoinfo clearfix three bg-white block">
                            <img src="images/demoimages/pic1.png" alt="" class="left">
                            <span class="twenty-six left">奶牛个巴子</span>
                            <em class="twenty-six right">10分钟前</em>
                        </a>
                    </a> -->
                </div>
                <!-- 最新修改-2018-4-11 -->
                <div id="page" class="text-center none">没有新数据了</div>
                <div class="loading"></div>
            </div>
            <div id="navigation"><a href="page.html?page=1"></a></div>
            <!-- 上下页 -->
            <!-- <div class="pub-page clearfix text-center twenty-six">
                <a href="" class="upper-page left nine">上一页</a>
                <a href="" class="lower-page left white">下一页</a>
            </div> -->
            <!-- 导航 -->
            <div class="nav bg-white clearfix position-fix">
                <a href="" class="index-nosel left"></a>
                <a href="" class="pic-sel left"></a>
                <a href="" class="video-nosel left"></a>
                <a href="" class="my-nosel left"></a>
            </div>
        </div>

        <script src="js/jquery-1.11.3.min.js" type="text/javascript"></script>
        <script src="js/index.js" type="text/javascript"></script>
        <!-- 懒加载 -->
        <!-- <script src="js/echo.min.js" type="text/javascript"></script> -->
        <!-- 滑动 -->
        <script src="js/swiper.3.1.7.jquery.min.js" type="text/javascript"></script>
        <!-- 瀑布流 -->
        <script src="js/masonry.pkgd.min.js" type="text/javascript"></script>
        <!-- 下拉刷新 -->
        <!-- <script src="js/dropload.min.js" type="text/javascript"></script> -->
        <script src="js/jquery.infinitescroll.min.js" type="text/javascript"></script>
        <script src="js/imagesloaded.pkgd.min.js" type="text/javascript"></script>
        <script>
            // 滑动
            var mySwipers = new Swiper ('.swiper-containers', {
                direction: 'horizontal',
                loop: false,
                freeMode : true,
                slidesPerView : "auto"
            })
            // 点击导航选项
            $(".pic-l-navitem").on("click", "span", function () {
                var _this = $(this);
                // 字体颜色处理
                _this.addClass("pic-l-navsel");
                _this.parent("").siblings(".pic-l-navitem").children("span").removeClass("pic-l-navsel");
                // 下划线处理
                _this.children("em").removeClass("none");
                _this.parent("").siblings(".pic-l-navitem").children("span").children("em").addClass("none");
            })

            // 瀑布流
            var $grid = $('#pic-l-list').masonry({  
                itemSelector: '.pic-l-item',  
                isAnimated: true,
                isResizableL: false,
                gutterWidth: 0
            });
            $grid.imagesLoaded().progress( function() {
                $grid.masonry('layout');
            });

            // 最新修改-2018-4-11
            /*$.ajax({
                url: '',
                type: 'POST',
                dataType: json,
                success: function (datas) {
                    var totalPage = datas;
                }
            })*/
            
            // 最新修改-2018-4-11
            var sp = 1;
            $('#pic-l-list').infinitescroll({
                navSelector: "#navigation", //导航的选择器，会被隐藏
                nextSelector: "#navigation a", //包含下一页链接的选择器
                itemSelector: ".pic-l-item", //你将要取回的选项(内容块)
                debug: true, //启用调试信息
                animate: true, //当有新数据加载进来的时候，页面是否有动画效果，默认没有
                // maxPage: 3, 
                extraScrollPx: 150, //滚动条距离底部多少像素的时候开始加载，默认150
                bufferPx: 40, //载入信息的显示时间，时间越大，载入信息显示时间越短
                errorCallback: function() {
                    $("#navigation").remove();
                    $("#infscr-loading").hide();
                    $("#page").show();
                    $(window).unbind('.infscr');
                }, //当出错的时候，比如404页面的时候执行的函数
                localMode: true, //是否允许载入具有相同函数的页面，默认为false
                dataType: 'html',//可以是json
//                template: function(data) {
//                    //data表示服务端返回的json格式数据，这里需要把data转换成瀑布流块的html格式，然后返回给回到函数
//                    return '';
//                },
                loading: {
                    selector: '.loading', // 显示loading信息的div
                    msgText: "加载中...",
                    finishedMsg: '没有新数据了...',
                    // 最新修改-2018-4-11
                    finished: function () {
                        sp++;
                        // 此处的8只是举例说明，此处因为服务端给的最大页数
                        if (sp >= 8) {
                            $("#navigation").remove();
                            $("#infscr-loading").hide();
                            $("#page").show();
                            $(window).unbind('.infscr');
                        }
                    },errorCallback: function() {
                        $("#page").show();
                    }
                }
            }, function(newElems) {
                //程序执行完的回调函数
                var $newElems = $(newElems);
                $('#pic-l-list').masonry('appended', $newElems);
                $grid.imagesLoaded().progress( function() {
                    $grid.masonry('layout');
                });
            });

            // 列表间距处理
            /*var itemIndex = 0;
            $(".pic-l-item").each(function (i) {
                if ($(this).prev("li").hasClass("pic-l-itemtwo")) {
                    itemIndex = 0;
                }
                if (itemIndex % 2 == 1) {
                    $(this).css({
                        "padding-right" : "0"
                    })
                }
                itemIndex++;
            })*/

            /*var winSH = window.screen.height;
            // 懒加载
            Echo.init({
                offset: winSH,
                throttle: 1
            });*/

            /*var imgNum = $('.pic-l-pics').size();
            var imgstarNum = 0;
            $('.pic-l-pics').load(function(){
                imgstarNum++;
                if (imgstarNum == imgNum) {
                    // 调用瀑布流插件
                    waterfall();
                }
            });

            // 瀑布流
            waterfall();
            function waterfall (argument) {
                $('#pic-l-list').masonry({  
                    itemSelector: '.pic-l-item',  
                    isAnimated: true,
                    isResizableL: false,
                    gutterWidth: 0 
                });
            }*/
            
            


            // 下拉刷新
            /*$(function(){
                var counter = 0;
                // 每页展示10个
                var num = 10;
                var pageStart = 0,pageEnd = 0;

                // dropload
                $(".pic-l-list").dropload({
                    scrollArea : window,
                    loadDownFn : function(me){
                        $.ajax({
                            type: 'post',
                            url: '',
                            dataType: 'json',
                            success: function(data){
                                var result = '';
                                counter++;
                                pageEnd = num * counter;
                                pageStart = pageEnd - num;

                                // 锁定
                                me.lock();
                                // 无数据
                                me.noData();
                                // break;
                                // 为了测试，延迟1秒加载
                                setTimeout(function(){
                                    // 每次数据加载完，必须重置
                                    me.resetload();
                                },1000);
                            },
                            error: function(xhr, type){
                                alert('Ajax error!');
                                // 即使加载出错，也得重置
                                me.resetload();
                            }
                        });
                    }
                });
            });*/

            
        </script>
    </body>
</html>